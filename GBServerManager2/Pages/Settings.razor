@page "/settings"

@using GBServerManager2.Models.Options
@inject ApplicationSettingsService _ass
@inject DialogService _ds

<div class="row div-TopSettingsBar">

</div>
<div class="row">
    <RadzenStack Orientation="Orientation.Horizontal">
    <img src="assets/blank-profile.png" class="profilePicture" />
    <h2 class="mt-1">[User Name]</h2>
    </RadzenStack>
</div>

<div class="row mt-3">
    <div class="d-flex justify-content-between">
        <h3>Application Settings</h3>
        <button class="btn btn-sm btn-rounded action-button" @onclick="OpenDialog">
            <i class="bi bi-pencil-fill button-icon"></i>
        </button>
    </div>
    <hr/>
    <div class="col-md-3 d-flex align-items-center">
            <Tooltip Text="Path to where all servers should be downloaded to.">
                <span class="SettingsText">Path to install servers:</span>
            </Tooltip>
    </div>
    <div class="col-md-9">
            <RadzenTextBox @bind-Value="serverPath" class="@(string.IsNullOrWhiteSpace(serverPath) ? "bg-warning w-75" : "w-75")"></RadzenTextBox>
    </div>
</div>

<div class="row mt-5">
    <h3>User Settings</h3>
    <hr/>
</div>

@code {
    private string serverPath;

    //protected override void OnInitialized()
    //{

    //}

    private void TestSettings()
    {

        AppSetting set = new() { Key = "DB Loc", Value = "Here" };
        ApplicationSettings settings = new() { ApplicationName = "Game Server Manager", Version = "1.0", Settings = new List<AppSetting>() { set } };

        var temp = _ass.GetAllApplicationSettings();
    }

    async Task OpenDialog()
    {
        await _ds.OpenSideAsync<AppSettingSideDialog>("Edit Settings", options: new SideDialogOptions {  CloseDialogOnOverlayClick = false, Position = DialogPosition.Right, ShowMask = true });
    }
}
